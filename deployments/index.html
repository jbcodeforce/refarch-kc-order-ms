



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.1">
    
    
      
        <title>Deploy to Kubernetes cluster - Order Microservice CQRS and Event Sourcing</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../extra.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#deployments" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Order Microservice CQRS and Event Sourcing" class="md-header-nav__button md-logo">
          
            <img src="../images/cloud.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Order Microservice CQRS and Event Sourcing
            </span>
            <span class="md-header-nav__topic">
              Deploy to Kubernetes cluster
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/ibm-cloud-architecture/refarch-kc-order-ms/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Order Microservice CQRS and Event Sourcing" class="md-nav__button md-logo">
      
        <img src="../images/cloud.png" width="48" height="48">
      
    </a>
    Order Microservice CQRS and Event Sourcing
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/ibm-cloud-architecture/refarch-kc-order-ms/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      From event storming to CQRS microservice
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        From event storming to CQRS microservice
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ddd-applied/" title="Order subdomain - analysis and design" class="md-nav__link">
      Order subdomain - analysis and design
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation-considerations/" title="Implementation considerations" class="md-nav__link">
      Implementation considerations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Development practices
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Development practices
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../build-run/" title="Build and run locally" class="md-nav__link">
      Build and run locally
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Deploy to Kubernetes cluster
      </label>
    
    <a href="./" title="Deploy to Kubernetes cluster" class="md-nav__link md-nav__link--active">
      Deploy to Kubernetes cluster
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#deployment-prerequisites" title="Deployment prerequisites" class="md-nav__link">
    Deployment prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-to-iks" title="Deploy to IKS" class="md-nav__link">
    Deploy to IKS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-to-openshift-container-platform-ocp" title="Deploy to OpenShift Container Platform (OCP)" class="md-nav__link">
    Deploy to OpenShift Container Platform (OCP)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deploy-to-ocp-311" title="Deploy to OCP 3.11" class="md-nav__link">
    Deploy to OCP 3.11
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://ibm-cloud-architecture.github.io/refarch-eda/design-patterns/event-sourcing" title="Event sourcing pattern" class="md-nav__link">
      Event sourcing pattern
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://ibm-cloud-architecture.github.io/refarch-eda/design-patterns/cqrs" title="CQRS pattern" class="md-nav__link">
      CQRS pattern
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://ibm-cloud-architecture.github.io/refarch-kc/itg-tests/" title="Integration tests" class="md-nav__link">
      Integration tests
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#deployment-prerequisites" title="Deployment prerequisites" class="md-nav__link">
    Deployment prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-to-iks" title="Deploy to IKS" class="md-nav__link">
    Deploy to IKS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-to-openshift-container-platform-ocp" title="Deploy to OpenShift Container Platform (OCP)" class="md-nav__link">
    Deploy to OpenShift Container Platform (OCP)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deploy-to-ocp-311" title="Deploy to OCP 3.11" class="md-nav__link">
    Deploy to OCP 3.11
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ibm-cloud-architecture/refarch-kc-order-ms/edit/master/docs/deployments.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="deployments">Deployments</h1>
<p>Be sure to have read the <a href="../build-run/">build and run article before</a>.</p>
<h2 id="deployment-prerequisites">Deployment prerequisites</h2>
<p>Regardless of specific deployment targets (OCP, IKS, k8s), the following prerequisite Kubernetes artifacts need to be created to support the deployments of application components.  These artifacts need to be created once per unique deployment of the entire application and can be shared between application components in the same overall application deployment.</p>
<ol>
<li>
<p>Create <code>kafka-brokers</code> ConfigMap</p>
<ul>
<li>Command: <code>kubectl create configmap kafka-brokers --from-literal=brokers='&lt;replace with comma-separated list of brokers&gt;' -n &lt;namespace&gt;</code></li>
<li>Example: <code>kubectl create configmap kafka-brokers --from-literal=brokers='broker-3-j7fxtxtp5fs84205.kafka.svc01.us-south.eventstreams.cloud.ibm.com:9093,broker-2-j7fxtxtp5fs84205.kafka.svc01.us-south.eventstreams.cloud.ibm.com:9093,broker-1-j7fxtxtp5fs84205.kafka.svc01.us-south.eventstreams.cloud.ibm.com:9093,broker-5-j7fxtxtp5fs84205.kafka.svc01.us-south.eventstreams.cloud.ibm.com:9093,broker-0-j7fxtxtp5fs84205.kafka.svc01.us-south.eventstreams.cloud.ibm.com:9093,broker-4-j7fxtxtp5fs84205.kafka.svc01.us-south.eventstreams.cloud.ibm.com:9093' -n eda-refarch</code></li>
</ul>
</li>
<li>
<p>Create optional <code>eventstreams-apikey</code> Secret, if you are using Event Streams as your Kafka broker provider. Get the API key from the user interface using an administrator user.</p>
<ul>
<li>Command: <code>kubectl create secret generic eventstreams-apikey --from-literal=binding='&lt;replace with api key&gt;' -n &lt;namespace&gt;</code></li>
<li>Example: <code>kubectl create secret generic eventstreams-apikey --from-literal=binding='z...12345...notanactualkey...67890...a' -n eda-refarch</code></li>
</ul>
</li>
<li>
<p>If you are using Event Streams as your Kafka broker provider and it is deployed via the IBM Cloud Pak for Integration (ICP4I), you will need to create an additional Secret to store the generated Certificates &amp; Truststores.</p>
<ul>
<li>From the "Connect to this cluster" tab on the landing page of your Event Streams installation, download both the <strong>Java truststore</strong> and the <strong>PEM certificate</strong>.</li>
<li>Create the Java truststore Secret:<ul>
<li>Command: <code>kubectl create secret generic &lt;secret-name&gt; --from-file=/path/to/downloaded/file.jks</code></li>
<li>Example: <code>kubectl create secret generic es-truststore-jks --from-file=/Users/osowski/Downloads/es-cert.jks</code></li>
</ul>
</li>
<li>Create the PEM certificate Secret:<ul>
<li>Command: <code>kubectl create secret generic &lt;secret-name&gt; --from-file=/path/to/downloaded/file.pem</code></li>
<li>Example: <code>kubectl create secret generic es-ca-pemfile --from-file=/Users/osowski/Downloads/es-cert.pem</code></li>
</ul>
</li>
</ul>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The name of those secrets are used in the Helm chart <code>values.yaml</code> and <code>deployment.yaml</code> files of each project. The <code>helm template</code> command will generate service and deployment yaml files with the good value for each chart. (See <a href="#deploy-to-ocp-311">section below</a>)</p>
<div class="codehilite"><pre><span></span><span class="n">kafka</span><span class="o">:</span>
  <span class="n">brokersConfigMap</span><span class="o">:</span> <span class="n">kafka</span><span class="o">-</span><span class="n">brokers</span>
<span class="n">eventstreams</span><span class="o">:</span>
  <span class="n">enabled</span><span class="o">:</span> <span class="kc">true</span>
  <span class="n">apikeyConfigMap</span><span class="o">:</span> <span class="n">eventstreams</span><span class="o">-</span><span class="n">apikey</span>
  <span class="n">truststoreRequired</span><span class="o">:</span> <span class="kc">true</span>
  <span class="n">truststorePath</span><span class="o">:</span> <span class="sr">/config/resources/security/</span><span class="n">es</span><span class="o">-</span><span class="n">ssl</span>
  <span class="n">truststoreFile</span><span class="o">:</span> <span class="n">es</span><span class="o">-</span><span class="n">cert</span><span class="o">.</span><span class="na">jks</span>
  <span class="n">truststoreSecret</span><span class="o">:</span> <span class="n">es</span><span class="o">-</span><span class="n">truststore</span><span class="o">-</span><span class="n">jks</span>
  <span class="n">truststorePassword</span><span class="o">:</span> <span class="n">changeit</span>
</pre></div>

</div>
<h2 id="deploy-to-iks">Deploy to IKS</h2>
<p>Be sure to have created an IBM kubernetes service cluster (See <a href="https://ibm-cloud-architecture.github.io/refarch-eda/training/eda-skill-journey/#5-hands-on-lab-prepare-ibm-cloud-iks-openshift-environment">this lab</a> for detail)</p>
<p>Once the two docker images are built, upload them to the IKS private registry</p>
<div class="codehilite"><pre><span></span>docker push us.icr.io/ibmcaseeda/kc-orderqueryms
docker push us.icr.io/ibmcaseeda/kc-ordercmdms
</pre></div>

<ul>
<li>Verify the images are in you private repo:</li>
</ul>
<div class="codehilite"><pre><span></span>ibmcloud cr image-list
</pre></div>

<ul>
<li>Deploy the helm charts for each service using the <code>scripts/deployHelm</code> under each project.</li>
</ul>
<div class="codehilite"><pre><span></span>cd order-command-ms
./scripts/deployHelm MINIKUBE

cd order-query-ms
./scripts/deployHelm MINIKUBE
</pre></div>

<ul>
<li>Verify the deployments and pods:</li>
</ul>
<div class="codehilite"><pre><span></span>kubectl get deployments -n browncompute
</pre></div>

<blockquote>
<table>
<thead>
<tr>
<th>NAME</th>
<th>DESIRED</th>
<th>CURRENT</th>
<th>UP-TO-DATE</th>
<th>AVAILABLE</th>
<th>AGE</th>
</tr>
</thead>
<tbody>
<tr>
<td>fleetms-deployment</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>23h</td>
</tr>
<tr>
<td>kc-ui</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>18h</td>
</tr>
<tr>
<td>ordercommandms-deployment</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1d</td>
</tr>
<tr>
<td>orderqueryms-deployment</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>23h</td>
</tr>
<tr>
<td>voyagesms-deployment</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>19h</td>
</tr>
</tbody>
</table>
</blockquote>
<h2 id="deploy-to-openshift-container-platform-ocp">Deploy to OpenShift Container Platform (OCP)</h2>
<h3 id="deploy-to-ocp-311">Deploy to OCP 3.11</h3>
<p><strong>Cross-component deployment prerequisites:</strong> <em>(needs to be done once per unique deployment of the entire application)</em></p>
<ol>
<li>
<p>If desired, create a non-default Service Account for usage of deploying and running the Reefer Container reference implementation.  This will become more important in future iterations, so it's best to start small:</p>
<ul>
<li>Command: <code>oc create serviceaccount -n &lt;target-namespace&gt; kcontainer-runtime</code></li>
<li>Example: <code>oc create serviceaccount -n eda-refarch kcontainer-runtime</code></li>
</ul>
</li>
<li>
<p>The target Service Account needs to be allowed to run containers as <code>anyuid</code> for the time being:</p>
<ul>
<li>Command: <code>oc adm policy add-scc-to-user anyuid -z &lt;service-account-name&gt; -n &lt;target-namespace&gt;</code></li>
<li>Example: <code>oc adm policy add-scc-to-user anyuid -z kcontainer-runtime -n eda-refarch</code></li>
<li>NOTE: This requires <code>cluster-admin</code> level privileges.</li>
</ul>
</li>
</ol>
<p><strong>Perform the following for both <code>order-command-ms</code> and <code>order-query-ms</code> microservices:</strong></p>
<ol>
<li>
<p>Build and push the Docker image by one of the two options below:</p>
<ul>
<li>Create a Jenkins project, pointing to the remote GitHub repository for the <code>order-command</code> and <code>order-query</code> microservices, and manually creating the necessary parameters.</li>
</ul>
<p>Refer to the <code>order-command</code> <a href="https://github.com/ibm-cloud-architecture/refarch-kc-order-ms/blob/master/order-command-ms/Jenkinsfile.NoKubernetesPlugin"><code>Jenkinsfile.NoKubernetesPlugin</code></a> or <code>order-query</code> <a href="https://github.com/ibm-cloud-architecture/refarch-kc-order-ms/blob/master/order-query-ms/Jenkinsfile.NoKubernetesPlugin"><code>Jenkinsfile.NoKubernetesPlugin</code></a> for appropriate parameter values.</p>
<ul>
<li>
<p>Manually build the Docker image and push it to a registry that is accessible from your cluster (Docker Hub, IBM Cloud Container Registry, manually deployed Quay instance):</p>
<ul>
<li><code>docker build -t &lt;private-registry&gt;/&lt;image-namespace&gt;/order-command-ms:latest order-command-ms/</code></li>
<li><code>docker build -t &lt;private-registry&gt;/&lt;image-namespace&gt;/order-query-ms:latest order-query-ms/</code></li>
<li><code>docker login &lt;private-registry&gt;</code></li>
<li><code>docker push &lt;private-registry&gt;/&lt;image-namespace&gt;/order-command-ms:latest</code></li>
<li><code>docker push &lt;private-registry&gt;/&lt;image-namespace&gt;/order-query-ms:latest</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>Generate application YAMLs via <code>helm template</code> for both <code>order-command</code> and <code>order-query</code>:</p>
<ul>
<li>Parameters:<ul>
<li><code>--set image.repository=&lt;private-registry&gt;/&lt;image-namespace&gt;/&lt;image-repository&gt;</code></li>
<li><code>--set image.pullSecret=&lt;private-registry-pullsecret&gt;</code> (only required if pulling from an external private registry)</li>
<li><code>--set kafka.brokersConfigMap=&lt;kafka brokers ConfigMap name&gt;</code></li>
<li><code>--set eventstreams.enabled=(true/false)</code> (<code>true</code> when connecting to Event Streams of any kind, <code>false</code> when connecting to Kafka directly)</li>
<li><code>--set eventstreams.apikeyConfigMap=&lt;kafka api key Secret name&gt;</code></li>
<li><code>--set eventstreams.truststoreRequired=(true/false)</code> (<code>true</code> when connecting to Event Streams via ICP4I)</li>
<li><code>--set eventstreams.truststoreSecret=&lt;eventstreams jks file secret name&gt;</code> (only used when connecting to Event Streams via ICP4I)</li>
<li><code>--set eventstreams.truststorePassword=&lt;eventstreams jks password&gt;</code> (only used when connecting to Event Streams via ICP4I)</li>
<li><code>--set serviceAccountName=&lt;service-account-name&gt;</code></li>
<li><code>--namespace &lt;target-namespace&gt;</code></li>
<li><code>--output-dir &lt;local-template-directory&gt;</code></li>
</ul>
</li>
<li>Example using Event Streams via ICP4I:</li>
</ul>
<p><div class="codehilite"><pre><span></span>helm template --set image.repository<span class="o">=</span>rhos-quay.internal-network.local/browncompute/order-command-ms --set kafka.brokersConfigMap<span class="o">=</span>es-kafka-brokers --set eventstreams.enabled<span class="o">=</span><span class="nb">true</span> --set eventstreams.apikeyConfigMap<span class="o">=</span>es-eventstreams-apikey --set <span class="nv">serviceAccountName</span><span class="o">=</span>kcontainer-runtime --set eventstreams.truststoreRequired<span class="o">=</span><span class="nb">true</span> --set eventstreams.truststoreSecret<span class="o">=</span>es-truststore-jks --set eventstreams.truststorePassword<span class="o">=</span>password --output-dir templates --namespace eda-pipelines-sandbox chart/ordercommandms
</pre></div>
  - Example using Event Streams hosted on IBM Cloud:
  <div class="codehilite"><pre><span></span>helm template --set image.repository<span class="o">=</span>rhos-quay.internal-network.local/browncompute/order-command-ms --set kafka.brokersConfigMap<span class="o">=</span>kafka-brokers --set eventstreams.enabled<span class="o">=</span><span class="nb">true</span> --set eventstreams.apikeyConfigMap<span class="o">=</span>eventstreams-apikey --set <span class="nv">serviceAccountName</span><span class="o">=</span>kcontainer-runtime --output-dir templates --namespace eda-pipelines-sandbox chart/ordercommandms
</pre></div></p>
</li>
<li>
<p>Deploy application using <code>oc apply</code>:</p>
<ul>
<li><code>oc apply -f templates/ordercommandms/templates</code></li>
</ul>
</li>
</ol>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../build-run/" title="Build and run locally" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Build and run locally
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.b806dc00.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>